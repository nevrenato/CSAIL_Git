
<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Csail git</title>
  </head>

	<nav>
		<li><a href="../index.html">Home</a></li>
		<li><a href="alloy.html">The Alloy Tool</a></li>
		<li><a href="introduction.html">Introduction to Git</a></li>
		<li><a href="gitworkflow.html">The Git WorkFlow</a></li>
		<li><a href="object_model.html">The Git Object Model</a></li>
		<li><a href="operations.html">Git Operations</a></li>
	<ul class="expanded">
		<li><a href="Addrm.html"> Git Add and Remove</a></li>
		<li><a href="CCommit.html"> Git Commit </a></li>
		<li><a href="Branch.html">Git Branch</a> </li>
		<li><a href="Checkout.html"> Git Checkout</a> </li>
		<li><a href="Merge.html"> Git Merge </a></li>
	</ul>
	<li><a href="Conclusion.html"> Conclusion </a></li>
	<li><a href="Properties.html"> Properties </a></li>
	<li><a href="ABugInGit.html"> Appendix </a></li> 

	</nav>


  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>The truth about Git</h1>
          <h2>Properties</h2>
        </header>

        <hr>

        <section id="main_content">

	<p>
	After the git internals and some operations were modeled,
	we checked for some properties. These properties are important to
	prove the correct behavior of the model. Such properties were checked using
	Alloy Analyzer, which tries to find counter examples for the
	properties. This analysis is bounded, which means that it is not a
	complete analysis, but instead it analyses the model up to
	'n' objects.
	</p>

	<h3>
		Invariant Preservation	
	</h3>

	<p>
		
	An invariant is a property that is always true in the model. In this
	section, we show that the operations we modeled preserve an invariant
	when they are performed. Our invariant says the following:
	</p><ul><li><p>
	There is a commit if and only if there is some created branch
   	and HEAD is known;
	</p></li><li><p>
	The HEAD identifies an existing branch;
	</p></li><li><p>
	Every branch points to a commit;
	</p></li><li><p>
	Each branch identifies only and only one commit;
	</p></li><li><p>
	There is not any object that does not descend from an existing
	commit;
	</p></li><li><p>
   	Every Tree has content (Blob and Trees) and these objects
   	exists in the repository;
	</p></li><li><p>
	Every commit object points to an existing tree and if it has
   	a parent it exists in the repository;
	</p></li><li><p>
	There are not two consecutive commits pointing to the same tree.
	</p></li></ul>
	<p>
	Most of these properties are trivial. The first property holds
	because before the first commit is created it is not possible to
	create branches, and after that it is never possible to remove the branch
	identified by HEAD. The property number 
	6 holds because git does not allow 
	empty Trees and every object contained in a
	tree exists in the repository. The last property guarantees
	that each existing commit has a different snapshot from its parent.
	</p>
	<p>
	To check if an operation preserves an invariant, that invariant must
	be valid after the operation is performed, assuming that is valid
	before. We have checked for each operation and
	we conclude that our operations preserve the invariant.
	</p>
	<h3>
		Idempotent Operations
	</h3>
	</section>
	<p>
	An operation is said idempotent if after being performed, repeating it
	does not change the state of the system. It does not make sense to
	check if this property holds for some operations. For example after
	removing a file or a branch, it cannot be removed again. The
	idempotent operations in our model are: commit, add, and checkout.
	Next we try to justify such property.
	</p>
	<p>
	The commit operation is idempotent because, if we perform a commit which 
	is equal to the previous, git will not create a new commit and nothing 
	is changed in the repository.
	</p>
	<p>
	The add operation is also idempotent because while the file in the
	working directory keeps its content the add operation, after performed
	the first time, does not brings any differences.
	</p>
	<p>
	The last operation we proved to be idempotent and maybe the less
	intuitive is the checkout. As we have seen in
	Checkout section, the checkout operation updates the index and
	the working directory to reflect the commit pointed by the branch being
	checked out. Even if there are some ''weird'' pre-conditions this
	operation is still idempotent.
	</p>
	<h3>
		Add, Remove and Commit Operations
	</h3>
	<p>
	For this operations we have checked the following properties, which
	were valid. Notice that when we write ''new file'', we mean a file
	that does not exists in index.
	</p><ul><li><p>
	Adding a new file to the index and removing it, brings us to the
   	initial state; </p></li><li><p>
   	If a commit is performed after an add operation, the added
   	file with the respective content will be in the commit pointed 
   	by the branch identified by HEAD;
	</p></li><li><p>
   	If a commit is performed after an remove operation, the
   	removed file will not be present in the commit pointed by the
   	branch identified by HEAD;
	</p></li><li><p>
   	If a commit is performed, a new file is added to index and a
   	new commit is performed, then the first commit and the second
  	commit will point to different Trees;
	</p></li><li><p> 
	Assuming that the invariant is verified and the following operations are
   	performed: commit, add a new file, commit, remove the file added
   	previously, and commit, then the first commit created and the last one
   	will point to the same Tree object;
	</p></li></ul>

	<h3>
	Branch and Checkout Operations
</h3>
	<p>
	For the branch operations (add and remove) we have checked two
	properties. We have checked if after creating a branch and then
	removing it we reach a state with the same branches as in the begin.
	We have also checked if when a branch is created it points to the same
	commit as the branch identified by HEAD. In both cases no counter
	examples were found.

	</p>
	<p>
	Relatively to the checkout operation it was verified the following:
	</p><ul><li><p>
	If when the invariant is
   	true and a checkout from a branch ''b'' is performed, then all content
   	from the commit pointed by ''b'' will be in index. Such property is
   	not true, due, the strange pre-condition we described in
   	Checkout section. As it is shown next, if the checkout
   	operation is performed exactly after a commit, the property holds.
	</p></li><li><p>
	If a commit is performed, a checkout from a random branch is
   	performed and after that a new checkout from the initial branch is also
   	performed, then the index content after the commit will be the same
   	as in the end.
   	</p></li></ul>
   	<footer>
	<p>  Csail git is maintained by Cláudio Lourenço and Renato Neves. 
	Project supervised by Alcino Cunha, Eunsuk Kang and José Barros.</p>	
	This page was generated by <a href="http://pages.github.com">GitHub Pages</a>.
	<br>
	Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>
	and altered by  Cláudio Lourenço and Renato Neves.
        </footer>

      </div>
    </div>
  </body>
