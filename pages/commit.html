<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print" />
    <!zzz--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Csail git</title>
  </head>

	<nav>
		<li><a href="../index.html">Home</a></li>
		<li><a href="alloy.html">The Alloy Tool</a></li>
		<li><a href="introduction.html">Introduction to Git</a></li>
		<li><a href="gitworkflow.html">The Git WorkFlow</a></li>
		<li><a href="object_model.html">The Git Object Model</a></li>
		<li><a href="operations.html">Git Operations</a></li>
	<ul class="expanded">
		<li><a href="Addrm.html"> Git Add and Remove</a></li>
		<li><a href="Commit.html"> Git Commit </a></li>
		<li><a href="Branch.html">Git Branch</a> </li>
		<li><a href="Checkout.html"> Git Checkout</a> </li>
		<li><a href="Merge.html"> Git Merge </a></li>
	</ul>
	<li><a href="Conclusion.html"> Conclusion </a></li>
	<li><a href="ABugInGit.html"> Appendix </a></li> 

	</nav>


  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>The truth about Git</h1>
          <h2>Commit</h2>
        </header>

        <hr>

        <section id="main_content">
        	
	<h3>Description</h3>
	<p>The commit operation takes the current index and builds a commit object. 
	Basically it takes the files from the index, builds a structure using 
	trees and blobs objects and creates a new commit object pointing 
	to the tree that corresponds to the project’s root directory. 
	This commit object will have as parent the current commit, the 
	commit pointed by the branch indicated in the HEAD. When 
	the first commit is created, a branch called "master" 
	will be created and it will be marked as the current branch, or 
	in other words, it will be indicated by HEAD. 
	Also, the first commit of the repository is called a Root Commit,
	because it has no parents. </p>
	<h3> Pre-conditions </h3>
	<p>There are three pre-conditions that are required to perform this
	operation:</p> 
	<ol><li><p>The index is not empty;
		</p></li>
		<li><p>
		The commit object that will be created is different from 
		the current commit;
		</p></li>
		<li><p>
		There are not unmerged files.
		</p></li>
	</ol>
	<p>	The first pre-condition is obvious, because if we do not have 
	files in the index, there is not anything to 
	commit. </p><p>
	The second condition says basically that we cannot have 
	two commits objects pointing to the same tree object in a row, 
	or in other words, if we have the same files and the 
	same content in the index and in the current commit, 
	a commit operation cannot be performed.</p><p>
	The last condition just says that it is not possible to 
	perform a commit, if there are unmerged files in index.
	As we have said before, we will speak about this later.
	</p>
	<h3> Result </h3>
	<p>The result of performing a commit can be different if it is 
	the first commit or if there are already some commits in th repository. 
	We start by exposing the observed result when the first commit is 
	being performed and then we show the case when there is already some 
	commit in the repository. </p><p>
	In the end we show some properties that are 
	observed in both cases. The first commit object that 
	is being created is a commit with no parent. There cannot be 
	branches at this moment, because they cannot point to any commit, 
	as there are none to be pointed, so a new branch called "master" is created. 
	This branch is going to point to the commit that has been created. 
	Also the HEAD, that previously was not defined will identify 
	this "master" branch.</p><p>When there are already some commits in the repository, 
	then it is guaranteed that there is at least one branch and the 
	HEAD is identifying some existing branch. The branch that is identified 
	by the HEAD, is pointing now to the commit created. This commit have now 
	as parent the previous commit (the commit that was previously pointed by 
	the branch identified by HEAD), unless it is a result from a merge. 
	In this case the commit must have two parents: the previous commit and 
	the branch that is being merged.</p><p>The common properties that are observed 
	are that all the files and content that were in the index, 
	are now in the current commit with the structure from the file system. 
	For this new blobs and trees were probably created. The index keeps exactly 
	the same content.</p>
	<h3> Examples </h3>
	<p>	The figure 8 shows a typical process where two files are 
	added to the index and then a commit is performed. 
	It can be seen that the new commit reflects the working directory’s 
	structure with these two files. The interesting point is that, 
	because these two files have the same content, they will share the same Blob. 
	This is a case where Git shows its efficiency. 
	The previous commit illustrates the case in which the first commit of the repository is 
	being performed. 
	</p>
	<!-- A image block -->
	<p>
	<img src = "../images/commit1.png" width=500 height=700 label="Doing a commit"/> 
	<font size="1" style="float:right;"> Figure 8 </font>
	</p>

	<p>
	In Figure 9 it is possible to see an example of a commit operation, 
	in which the only difference from the previous commit is a removed file. 
	This figure is interesting because it shows which changes are made in the repository when 
	a new (non root) commit is created. The new commit points to the previous commit 
	and the branch (which is identified by HEAD) points to the just created commit. 
	As expected the new commit reflects the working directory’s structure for 
	the existing files.</p>
	<!-- A image block -->
	<p>
	<img src = "../images/commit2.png" width=500 height=700 label="Doing a
	second commit"/> 
	<font size="1" style="float:right;"> Figure 9 </font>
	</p>

	<p>Figure 10 is just a concrete example of the 
	second pre requisite referred above. In this case the commit cannot be
	performed. </p>
	<!-- A image block -->
	<p>
	<img src = "../images/commit_pre.png" width=320 height=300 label="Doing a
	second commit"/> 
	<font size="1" style="float:right;"> Figure 10 </font>
	</p>

	
	</section>

        <footer>
	<p>  Csail git is maintained by Cláudio Lourenço and Renato Neves. 
	Project supervised by Alcino Cunha, Eunsuk Kang and José Barros.</p>	
	This page was generated by <a href="http://pages.github.com">GitHub Pages</a>.
	<br>
	Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>
	and altered by  Cláudio Lourenço and Renato Neves.
        </footer>

      </div>
    </div>
  </body>
